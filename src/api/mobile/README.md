# Mobile API Description

The mobile APIs will communicate with skycoin-exchange, so make sure you have a running skycoin-exchange. 
If you don't have, follow the instructions here: [skycoin exchange](https://github.com/skycoin/skycoin-exchange)
to install and run a exchange server.

## Build

Use the following cmd to build an ios framework file; for android just replace the target `ios` with `android`.

```bash
$ gomobile bind -target=ios github.com/skycoin/skycoin-exchange/src/api/mobile
```

## APIs

### Initialization

```go
func Init(cfg *Config)
```

We use `Config` to init the API env, there're two fields in the struct, wallet dir
and exchange server address(`ip:port`, eg: `127.0.0.1:8080`). Wallet dir is the place for persisting the
wallet files;


### Create wallet

Create wallet base on coin type and seed.

```go
func NewWallet(coinType string, seed string) (string, error)
```

Params:

* coinType: can be `bitcoin` or `skycoin`
* seed: wallet seed, can be any string, but make sure it's different from the skycoin exchange seed

Return:

* frist: wallet id
* second: error info

### Create address

This api is used to create addresses in specific wallet.

```go
func NewAddress(walletID string, num int) (string, error)
```

Params:

* walletID: wallet id, which was generated by `NewWallet` api
* num: the address number you need to generate

Return:

* first: address entries json, eg:

```json
{
    "addresses": [
        {
            "address": "QNpH7Y2spJtSAbdufM4qwchWvg71mAsbNx",
            "pubkey": "02e1eaa54233495faed0d50ecbfdc3e2e9fcac829b3d406a4d7bde43ff4452a0f7",
            "seckey": "58824dc46b14e28ecd0a4e93835a61129c770dda58073e8a7bd042d6b5f32a17"
        },
        {
            "address": "2Wm8wyZPh6HtFUBMAEewA2ZHxXbAvX4n5En",
            "pubkey": "0263c39ab3dba2c0bc8c08d4fdab297a21ff4505679cb7b8d832af27e4db7a0344",
            "seckey": "81c0fb22b4a23570f0bc7d30bade4bfca47f6d7f9e0a59613a54eccc333197ed"
        }
    ]
}
```

* second: error info

### Get addresses in wallet

This api is used to get all generated addresses in specific wallet

```go
func GetAddresses(walletID string) (string, error)
```

Params:

* walletID: wallet id

Return:

* first: address list json, eg:

```json
{
    "addresses": [
        "QNpH7Y2spJtSAbdufM4qwchWvg71mAsbNx",
        "2Wm8wyZPh6HtFUBMAEewA2ZHxXbAvX4n5En"
    ]
}
```

### Get pubkey and seckey pair of address

This api is used to get keypair of specific address.

```go
func GetKeyPairOfAddr(walletID string, addr string) (string, error)
```

Param:

* walletID: id of the wallet you are going to query
* addr: coin address

Return:

* first: keypair json, eg:

```json
{
    "pubkey": "02e1eaa54233495faed0d50ecbfdc3e2e9fcac829b3d406a4d7bde43ff4452a0f7",
    "seckey": "KzBm5cmRgGEgPESM3izfvesdz8caf14c6pZ3spG5eaJNE9abZmuc"
}
```

* second: error info

### Get balance

This api is used to query the balance of specific address.

```go
func GetBalance(coinType string, address string) (string, error)
```

Params:

* coinType: the coin type, can be `skycoin` or `bitcoin`
* address: coin address

Return:

* frist: balance json, eg:

```json
{
    "balance":4000000
}
```

the balance unit of skycoin is `drop`, bitcoin is `satoshi`.

### Send skycoin

This api can be used to send skycoin to one recipient address.

```go
func SendSky(walletID string, toAddr string, amount string) (string, error)
```

Params:

* walletID: wallet id
* toAddr: recipient address
* amount: the coins you will send, it's value must be the multiple of 1e6.

Return:

* first: txid json, eg:

```json
{
    "txid":"05d52650917f4233795d12e76f7f228409863ce8b304b0d0dfc778f2b023112a"
}
```

* second: error info

### Send bitcoin

This api can be used to send bitcoin to one recipient address.

Note: As we use the apis from blockexplorer.com to get utxos and
broadcast transaction, sometime it could be very slow and have no response.

```go
func SendBtc(walletID string, toAddr string, amount string, fee string) (string, error)
```

Params:

* walletID: wallet id
* toAddr: recipient address
* amount: the coins you will send
* fee: bitcoin fee, must >= 1000

Return:

* first: txid json as send skycoin's
* second: error info.